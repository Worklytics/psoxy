# Deployment Migration

## Overview
This document describes how to migrate your deployment from one cloud provider to another, or
one project/account to another. It does not cover migrating between proxy versions.

### Preserving Existing Infrastructure

Some data/infrastructure MUST, or at least SHOULD be preserved during your migration. Below is
an enumeration of both cases.

What you MUST preserve:
  - **`SALT` value**. This is a secret used to generate the pseudonyms. If this is lost/destroyed,
    you will be unable to link any data pseudonymized with the original salt to data you process in
    the future.
  - **value for `PSEUDONYMIZE_APP_IDS`.** This value, if set to `true` will have the proxy use a rule
    set that pseudonymizes identifiers issued by source applications themselves in some cases where
    these identifiers aren't inherently PII - but the association could be considered discoverable.
  - any **custom sanitization rules** that you've set, either in your Terraform configuration
    or directly as the value of a `RULES` environment variable, SSM Parameter, or GCP Secret.

What you SHOULD preserve:
  - **API Clients**. Whether generated by Terraform or not, the "API Client" for a data source must
    typically be authorized by a data source administrator to grant it access to the data source. As
    such, if you destroy the client, or lose its id, you'll need to coordinate with the administrator
    again to recreate it / obtain the configuration information.
  - **API Client Secrets**, if generated outside of Terraform. If you destroy/lose these values,
    you'll need to contact the data source administrator to obtain new versions.

## Account/Project Migration

Use cases:
  - move from a `dev` account to a `dev` account
  - move from a "shared" account to a "dedicated" account

TBC

## Cross-Provider Migration

eg, GCP --> AWS or vice-versa

Use cases:
  - change host provider from GCP to AWS or vice-versa

TBC
