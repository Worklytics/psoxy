---
endpoints:
  - pathTemplate: "/{apiVersion}/teams"
    allowedQueryParams:
      - "$select"
      - "$top"
      - "$skipToken"
      - "$filter"
      - "$count"
    transforms:
      - !<redact>
        jsonPaths:
          - "$..displayName"
          - "$..description"
      - !<pseudonymize>
        jsonPaths:
          - "$..user.id"
        encoding: "JSON"
      - !<redact>
        jsonPaths:
          - "$..['@odata.context']"
      - !<redact>
        jsonPaths:
          - "$..['@odata.id']"
      - !<redact>
        jsonPaths:
          - "$..['@odata.type']"
      - !<redact>
        jsonPaths:
          - "$..['@odata.count']"
  - pathTemplate: "/{apiVersion}/teams/{teamId}/allChannels"
    allowedQueryParams:
      - "$select"
      - "$filter"
    transforms:
      - !<redact>
        jsonPaths:
          - "$..displayName"
          - "$..description"
      - !<pseudonymize>
        jsonPaths:
          - "$..user.id"
        encoding: "JSON"
      - !<redact>
        jsonPaths:
          - "$..['@odata.context']"
      - !<redact>
        jsonPaths:
          - "$..['@odata.id']"
      - !<redact>
        jsonPaths:
          - "$..['@odata.type']"
      - !<redact>
        jsonPaths:
          - "$..['@odata.count']"
  - pathTemplate: "/{apiVersion}/users/{userId}/chats"
    allowedQueryParams:
      - "$select"
      - "$top"
      - "$skipToken"
      - "$filter"
      - "$orderBy"
      - "$expand"
    transforms:
      - !<redact>
        jsonPaths:
          - "$..topic"
      - !<pseudonymize>
        jsonPaths:
          - "$..user.id"
        encoding: "JSON"
      - !<redact>
        jsonPaths:
          - "$..['@odata.context']"
      - !<redact>
        jsonPaths:
          - "$..['@odata.count']"
  - pathTemplate: "/{apiVersion}/teams/{teamId}/channels/{channelId}/messages"
    allowedQueryParams:
      - "$select"
      - "$top"
      - "$skipToken"
      - "$expand"
    transforms:
      - !<redact>
        jsonPaths:
          - "$..user.displayName"
          - "$..body.content"
          - "$..attachments"
          - "$..mentions[*].mentionText"
          - "$..eventDetail.teamDescription"
      - !<pseudonymize>
        jsonPaths:
          - "$..user.id"
        encoding: "JSON"
      - !<redact>
        jsonPaths:
          - "$..['@odata.context']"
      - !<redact>
        jsonPaths:
          - "$..['@odata.count']"
      - !<redact>
        jsonPaths:
          - "$..['@odata.type']"
      - !<tokenize>
        jsonPaths:
          - "$.['@odata.nextLink', '@odata.prevLink', 'sessions@odata.nextLink']"
  - pathTemplate: "/{apiVersion}/teams/{teamId}/channels/{channelId}/messages/delta"
    allowedQueryParams:
      - "$select"
      - "$top"
      - "$skipToken"
      - "$expand"
      - "$deltaToken"
    transforms:
      - !<redact>
        jsonPaths:
          - "$..user.displayName"
          - "$..value[*].body.content"
          - "$..value[*].attachments"
          - "$..value[*].mentions[*].mentionText"
          - "$..value[*].eventDetail.teamDescription"
      - !<pseudonymize>
        jsonPaths:
          - "$..user.id"
        encoding: "JSON"
      - !<redact>
        jsonPaths:
          - "$..['@odata.context']"
      - !<redact>
        jsonPaths:
          - "$..['@odata.count']"
      - !<redact>
        jsonPaths:
          - "$..['@odata.type']"
      - !<tokenize>
        jsonPaths:
          - "$.['@odata.nextLink', '@odata.prevLink', 'sessions@odata.nextLink']"
  - pathTemplate: "/{apiVersion}/chats/{chatId}/messages"
    allowedQueryParams:
      - "$select"
      - "$top"
      - "$skipToken"
      - "$filter"
      - "$orderBy"
      - "$count"
      - "$expand"
      - "$format"
      - "$search"
      - "$skip"
    transforms:
      - !<redact>
        jsonPaths:
          - "$..user.displayName"
          - "$..value[*].body.content"
          - "$..value[*].attachments"
          - "$..value[*].mentions[*].mentionText"
          - "$..value[*].eventDetail.teamDescription"
      - !<pseudonymize>
        jsonPaths:
          - "$..user.id"
        encoding: "JSON"
      - !<redact>
        jsonPaths:
          - "$..['@odata.context']"
      - !<redact>
        jsonPaths:
          - "$..['@odata.count']"
      - !<redact>
        jsonPaths:
          - "$..['@odata.type']"
      - !<tokenize>
        jsonPaths:
          - "$.['@odata.nextLink', '@odata.prevLink', 'sessions@odata.nextLink']"
  - pathTemplate: "/{apiVersion}/communications/calls/{callId}"
    allowedQueryParams:
      - "$select"
      - "$top"
      - "$expand"
    transforms:
      - !<redact>
        jsonPaths:
          - "$..displayName"
      - !<pseudonymize>
        jsonPaths:
          - "$..user.id"
        encoding: "JSON"
      - !<redact>
        jsonPaths:
          - "$..['@odata.context']"
      - !<redact>
        jsonPaths:
          - "$..['@odata.count']"
      - !<redact>
        jsonPaths:
          - "$..['@odata.type']"
  - pathTemplate: "/{apiVersion}/communications/callRecords/{callChainId}"
    allowedQueryParams:
      - "$select"
      - "$expand"
    transforms:
      - !<redact>
        jsonPaths:
          - "$..user.displayName"
          - "$..reflexiveIPAddress"
          - "$..relayIPAddress"
          - "$..ipAddress"
          - "$..subnet"
          - "$..macAddress"
      - !<pseudonymize>
        jsonPaths:
          - "$..user.id"
        encoding: "JSON"
      - !<redact>
        jsonPaths:
          - "$..['@odata.context']"
      - !<redact>
        jsonPaths:
          - "$..['@odata.type']"
      - !<tokenize>
        jsonPaths:
          - "$.['@odata.nextLink', '@odata.prevLink', 'sessions@odata.nextLink']"
  - pathTemplate: "/{apiVersion}/users/{userId}/onlineMeetings"
    allowedQueryParams:
      - "$select"
      - "$top"
      - "$skipToken"
      - "$filter"
      - "$orderBy"
      - "$count"
      - "$expand"
      - "$format"
      - "$search"
      - "$skip"
    transforms:
      - !<redact>
        jsonPaths:
          - "$..user.displayName"
          - "$..subject"
          - "$..joinMeetingIdSettings"
      - !<pseudonymize>
        jsonPaths:
          - "$..user.id"
        encoding: "JSON"
      - !<redact>
        jsonPaths:
          - "$..['@odata.context']"
      - !<redact>
        jsonPaths:
          - "$..['@odata.type']"
