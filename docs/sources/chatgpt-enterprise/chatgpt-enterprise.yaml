---
endpoints:
  - pathTemplate: "/v1/compliance/workspaces/{workspaceId}/automations"
    allowedQueryParams:
      - "after"
      - "limit"
    transforms:
      - !<textDigest>
        jsonPaths:
          - "$.data[*].title"
          - "$.data[*].prompt"
    responseSchema:
      type: "object"
      properties:
        data:
          type: "array"
          items:
            $ref: "#/definitions/ExportAutomation"
        has_more:
          type: "boolean"
        last_id:
          type: "string"
        object:
          type: "string"
  - pathTemplate: "/v1/compliance/workspaces/{workspaceId}/conversations"
    allowedQueryParams:
      - "since_timestamp"
      - "after"
      - "limit"
      - "users"
      - "file_format"
    transforms:
      - !<pseudonymize>
        jsonPaths:
          - "$.data[*].user_email"
          - "$.data[*].user_id"
        encoding: "URL_SAFE_TOKEN"
      - !<textDigest>
        jsonPaths:
          - "$.data[*].title"
    responseSchema:
      type: "object"
      properties:
        data:
          type: "array"
          items:
            $ref: "#/definitions/Conversation"
        has_more:
          type: "boolean"
        last_id:
          type: "string"
        object:
          type: "string"
  - pathTemplate: "/v1/compliance/workspaces/{workspaceId}/conversations/{conversationId}/messages"
    allowedQueryParams:
      - "after"
      - "limit"
    transforms:
      - !<pseudonymize>
        jsonPaths:
          - "$.data[*].user_email"
        encoding: "URL_SAFE_TOKEN"
      - !<textDigest>
        jsonPaths:
          - "$.data[*].content.value"
    responseSchema:
      type: "object"
      properties:
        data:
          type: "array"
          items:
            $ref: "#/definitions/Message"
        has_more:
          type: "boolean"
        last_id:
          type: "string"
        object:
          type: "string"
  - pathTemplate: "/v1/compliance/workspaces/{workspaceId}/projects"
    allowedQueryParams:
      - "after"
      - "limit"
    transforms:
      - !<pseudonymize>
        jsonPaths:
          - "$.data[*].owner_email"
          - "$.data[*].owner_id"
          - "$..email"
          - "$.data[*].sharing.recipients[*].id"
        encoding: "URL_SAFE_TOKEN"
      - !<redact>
        jsonPaths:
          - "$.data[*].latest_config[*].name"
          - "$.data[*].latest_config[*].description"
      - !<textDigest>
        jsonPaths:
          - "$..conversation_starters[*]"
          - "$..instructions"
    responseSchema:
      type: "object"
      properties:
        data:
          type: "array"
          items:
            $ref: "#/definitions/Project"
        has_more:
          type: "boolean"
        last_id:
          type: "string"
        object:
          type: "string"
  - pathTemplate: "/v1/compliance/workspaces/{workspaceId}/users"
    allowedQueryParams:
      - "after"
      - "limit"
    transforms:
      - !<pseudonymize>
        jsonPaths:
          - "$.data[*].email"
        encoding: "URL_SAFE_TOKEN"
      - !<pseudonymize>
        jsonPaths:
          - "$.data[*].id"
        includeReversible: true
        encoding: "URL_SAFE_TOKEN"
      - !<redact>
        jsonPaths:
          - "$.data[*].display_name"
    responseSchema:
      type: "object"
      properties:
        data:
          type: "array"
          items:
            $ref: "#/definitions/WorkspaceUser"
        has_more:
          type: "boolean"
        last_id:
          type: "string"
        object:
          type: "string"
definitions:
  BaseFile:
    type: "object"
    properties:
      created_at:
        type: "number"
      id:
        type: "string"
      object:
        type: "string"
  Conversation:
    type: "object"
    properties:
      created_at:
        type: "number"
      id:
        type: "string"
      last_active_at:
        type: "number"
      messages:
        $ref: "#/definitions/MessageList"
      object:
        type: "string"
      title:
        type: "string"
      user_email:
        type: "string"
      user_id:
        type: "string"
      workspace_id:
        type: "string"
  ExportAutomation:
    type: "object"
    properties:
      id:
        type: "string"
      is_enabled:
        type: "boolean"
      prompt:
        type: "string"
      schedule:
        type: "string"
  Message:
    type: "object"
    properties:
      author:
        $ref: "#/definitions/MessageAuthor"
      content:
        $ref: "#/definitions/MessageContent"
      created_at:
        type: "number"
      files:
        type: "array"
        items:
          $ref: "#/definitions/BaseFile"
      gpt_id:
        type: "string"
      id:
        type: "string"
      object:
        type: "string"
      parent_id:
        type: "string"
      project_id:
        type: "string"
  MessageAuthor:
    type: "object"
    properties:
      object:
        type: "string"
      role:
        type: "string"
      tool_name:
        type: "string"
  MessageContent:
    type: "object"
    properties:
      object:
        type: "string"
      type:
        type: "string"
      value:
        type: "string"
  MessageList:
    type: "object"
    properties:
      data:
        type: "array"
        items:
          $ref: "#/definitions/Message"
      has_more:
        type: "boolean"
      last_id:
        type: "string"
      object:
        type: "string"
  Permissions:
    type: "object"
    properties:
      can_read:
        type: "boolean"
      can_view_config:
        type: "boolean"
      can_write:
        type: "boolean"
      object:
        type: "string"
  Project:
    type: "object"
    properties:
      builder_name:
        type: "string"
      created_at:
        type: "number"
      id:
        type: "string"
      latest_config:
        type: "array"
        items:
          $ref: "#/definitions/ProjectConfig"
      object:
        type: "string"
      owner_email:
        type: "string"
      owner_id:
        type: "string"
      sharing:
        $ref: "#/definitions/Sharing"
  ProjectConfig:
    type: "object"
    properties:
      categories:
        type: "array"
        items:
          type: "string"
      conversation_starters:
        type: "array"
        items:
          type: "string"
      created_at:
        type: "number"
      files:
        type: "array"
        items:
          $ref: "#/definitions/BaseFile"
      id:
        type: "string"
      instructions:
        type: "string"
      object:
        type: "string"
      tools:
        type: "array"
        items:
          $ref: "#/definitions/ProjectTool"
  ProjectTool:
    type: "object"
    properties:
      action_domain:
        type: "string"
      created_at:
        type: "number"
      type:
        type: "string"
  Recipient:
    type: "object"
    properties:
      email:
        type: "string"
      id:
        type: "string"
      object:
        type: "string"
      permissions:
        $ref: "#/definitions/Permissions"
  Sharing:
    type: "object"
    properties:
      object:
        type: "string"
      permissions:
        $ref: "#/definitions/Permissions"
      recipients:
        type: "array"
        items:
          $ref: "#/definitions/Recipient"
      visibility:
        type: "string"
  WorkspaceUser:
    type: "object"
    properties:
      created_at:
        type: "number"
      email:
        type: "string"
      id:
        type: "string"
      object:
        type: "string"
      role:
        type: "string"
      status:
        type: "string"
